<!doctype html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="author" content="Stuart Blackler "><meta name="description" content="This post describes how to enable HSTS in ASP.Net MVC using an ActionFilter "><meta name="keywords" content=",csharp,dotnet,mvc"><meta name="robots" content="noodp"><meta name="theme-color" content><link rel="canonical" href="https://im5tu.io/article/2014/04/enabling-http-strict-transport-security-hsts-via-asp-net-mvc-actionfilters/"><title>Enabling HTTP Strict Transport Security HSTS via ASP Net MVC ActionFilters :: CodeWithStu's Blog</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" integrity="sha512-Cv93isQdFwaKBV+Z4X8kaVBYWHST58Xb/jVOcV9aRsGSArZsgAnFIhMpDoMDcFNoUtday1hdjn0nGp3+KZyyFw==" crossorigin="anonymous" referrerpolicy="no-referrer"><link rel="stylesheet" href="https://im5tu.io/main.b78c3be9451dc4ca61ca377f3dc2cf2e6345a44c2bae46216a322ef366daa399.css" integrity="sha256-t4w76UUdxMphyjd/PcLPLmNFpEwrrkYhajIu82bao5k="><link rel="apple-touch-icon" sizes="180x180" href="https://im5tu.io/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://im5tu.io/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://im5tu.io/favicon-16x16.png"><link rel="manifest" href="https://im5tu.io/site.webmanifest"><link rel="mask-icon" href="https://im5tu.io/safari-pinned-tab.svg" color><link rel="shortcut icon" href="https://im5tu.io/favicon.ico"><meta name="msapplication-TileColor" content><meta itemprop="name" content="Enabling HTTP Strict Transport Security HSTS via ASP Net MVC ActionFilters"><meta itemprop="description" content="This post describes how to enable HSTS in ASP.Net MVC using an ActionFilter "><meta itemprop="datePublished" content="2014-04-21T18:19:47+00:00"><meta itemprop="dateModified" content="2014-04-21T18:19:47+00:00"><meta itemprop="wordCount" content="907"><meta itemprop="keywords" content="csharp,dotnet,mvc,"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Enabling HTTP Strict Transport Security HSTS via ASP Net MVC ActionFilters"><meta name="twitter:description" content="This post describes how to enable HSTS in ASP.Net MVC using an ActionFilter "><meta property="og:title" content="Enabling HTTP Strict Transport Security HSTS via ASP Net MVC ActionFilters"><meta property="og:description" content="This post describes how to enable HSTS in ASP.Net MVC using an ActionFilter "><meta property="og:type" content="article"><meta property="og:url" content="https://im5tu.io/article/2014/04/enabling-http-strict-transport-security-hsts-via-asp-net-mvc-actionfilters/"><meta property="article:section" content="article"><meta property="article:published_time" content="2014-04-21T18:19:47+00:00"><meta property="article:modified_time" content="2014-04-21T18:19:47+00:00"><meta property="article:section" content="Development"><meta property="article:published_time" content="2014-04-21 18:19:47 +0000 UTC"><link rel="alternate" type="application/rss+xml" href="https://im5tu.io/article/2014/04/enabling-http-strict-transport-security-hsts-via-asp-net-mvc-actionfilters/index.xml" title="CodeWithStu's Blog"><meta property="og:image" content="https://im5tu.io/img/profile.png"><meta property="og:site_name" content="CodeWithStu's Blog"><link rel="alternate" type="application/rss+xml" href="https://im5tu.io/article/index.xml" title="Stuart Blackler's Blog"><link rel="preconnect" href="https://api.github.com"><link rel="preconnect" href="https://partner.googleadservices.com"><link rel="preconnect" href="https://tpc.googlesyndication.com"><link rel="preconnect" href="https://www.googletagservices.com"><link rel="preconnect" href="https://googleads.g.doubleclick.net"><link rel="preconnect" href="https://pagead2.googlesyndication.com"><link rel="preload" href="https://im5tu.io/fonts/Inter-UI-Bold.woff2"><link rel="preload" href="https://im5tu.io/fonts/Inter-UI-Regular.woff2"><style>.post{max-width:1200px}.header__inner{width:100%;max-width:1160px}.logo__cursor{background:#3b82f6}.toolbar{display:none!important}.copy-code-button{float:right;display:block;padding:8px 12px;font-size:.9em;background-color:#e2e2e2;border-left:1px solid #e2e2e2;border-bottom:1px solid #e2e2e2;border-radius:0;border-bottom-left-radius:10px;transition:all 250ms ease;margin:-18px;opacity:0}.copy-code-button:hover{cursor:pointer;opacity:.7;border-style:solid}.copy-code-button:focus{background-color:#e2e2e2;outline:0;border-style:solid}.copy-code-button:active{background-color:#e2e2e2;opacity:.5;border-style:solid}pre:hover .copy-code-button{opacity:1}.copy-code-button~pre{position:relative}table{width:100%;border-collapse:collapse}table th{background-color:#cecece;color:#222}table tr{margin:0;padding:0}table tr:first-child{border-left:1px solid #acacac;border-top:1px solid #acacac;border-right:1px solid #acacac}table tr td:first-child{border-left:1px solid #acacac}table tr td:last-child{border-right:1px solid #acacac}table td,table th{padding:.5em;border-bottom:1px solid #acacac;margin:0}h2{margin-top:1.5em}h2 a:link,h2 a:visited,h3 a:link,h3 a:visited,h4 a:link,h4 a:visited,h5 a:link,h5 a:visited{text-decoration:none}h2 a:hover,h3 a:hover,h4 a:hover,h5 a:hover{text-decoration:underline}#promotions img{margin:20px auto}#sponsorMessage{width:100%;background:#ffdf00;color:#242325;padding:10px;font-size:.9em}.flex-container{width:100%;display:inline-flex;justify-content:space-between}.flex-box{display:block}.hidden{display:hidden}.post-title{font-weight:700}.post-summary{font-style:italic;font-size:.8em;color:#222}.post-tags{font-size:.9em}.post-tags span.tag{margin:0 .5em;color:#111;text-decoration:underline}@media print{.copy-code-button{display:none}}@media(prefers-color-scheme:dark){.copy-code-button{background-color:#969696;color:#323232}.post-summary,.post-tags span.tag{color:#eaeaea}}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QLMVXHCJ5K"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QLMVXHCJ5K")</script><script data-ad-client="ca-pub-8597760177900459" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div class="container"><header class="header"><span class="header__inner"><a href="https://im5tu.io/" style="text-decoration:none"><div class="logo"><span class="logo__mark">></span>
<span class="logo__text">im5tu.io</span>
<span class="logo__cursor"></span></div></a><span class="header__right"><nav class="menu"><ul class="menu__inner"><li><a href="https://im5tu.io/article/">Blog</a></li><li><a href="https://news.codewithstu.tv">Newsletter</a></li><li><a href="https://www.patreon.com/CodeWithStu">Patreon</a></li><li><a href="https://im5tu.io/article/index.xml">RSS</a></li><li><a href="https://twitter.com/CodeWithStu">Twitter</a></li><li><a href="https://codewithstu.tv">YouTube</a></li></ul></nav><span class="menu-trigger"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class="content"><main class="post"><div style="font-style:italic;width:100%;background-color:#ffe12b;color:#333;text-align:center;padding:1px"><p>This page is available to sponsor. <a id="sponsorLink" href="https://im5tu.io/sponsorship/" ref="nofollow" target="_blank">Click Here</a> for more details!</p></div><div class="post-info"><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>5 minutes</p></div><article><h1 class="post-title"><a href="https://im5tu.io/article/2014/04/enabling-http-strict-transport-security-hsts-via-asp-net-mvc-actionfilters/">Enabling HTTP Strict Transport Security HSTS via ASP Net MVC ActionFilters</a></h1><hr><aside id="toc"><div class="toc-title">Table of Contents</div><nav id="TableOfContents"><ul><li><a href="#passive-network-attacks">Passive Network Attacks</a></li><li><a href="#active-network-attacks">Active Network Attacks</a></li><li><a href="#website-development--deployment-bugs">Website Development & Deployment Bugs</a></li><li><a href="#implementation-details">Implementation Details</a></li><li><a href="#implementing-hsts-as-an-action-filter">Implementing HSTS as an action filter</a></li><li><a href="#browser-support">Browser support</a></li></ul></nav></aside><hr><div class="post-content"><p>After reading <a href="http://www.troyhunt.com/">Troy Hunt&rsquo;s</a> free ebook on the <a href="http://www.troyhunt.com/2011/12/free-ebook-owasp-top-10-for-net.html">OWASP Top 10 for .Net Developers</a>, I discovered an additional mechanism to help developers secure their websites. That mechanism is HTTP Strict Transport Security.</p><blockquote><p>HTTP Strict Transport Security (HSTS) is an opt-in security enhancement that is specified by a web application through the use of a special response header. Once a supported browser receives this header that browser will prevent any communications from being sent over HTTP to the specified domain and will instead send all communications over HTTPS. It also prevents HTTPS click through prompts on browsers. The specification has been released and published end of 2012 as <a href="https://tools.ietf.org/html/rfc6797">RFC 6797</a>. <a href="https://www.owasp.org/index.php/HTTP_Strict_Transport_Security">Source</a></p></blockquote><p>There are three main categories of attacks that are addressed in this specification: Passive Network Attacks, Active Network Attacks and Web Site Development & Deployment Bugs. These are present in <a href="https://tools.ietf.org/html/rfc6797">RFC 6797 - Section 2.3.1</a> but are re-produced here.</p><h2 id="passive-network-attacks">Passive Network Attacks</h2><blockquote><p>When a user browses the web on a local wireless network (e.g., an
802.11-based wireless local area network) a nearby attacker can
possibly eavesdrop on the user&rsquo;s unencrypted Internet Protocol-based
connections, such as HTTP, regardless of whether or not the local
wireless network itself is secured [BeckTews09]. Freely available
wireless sniffing toolkits (e.g., [Aircrack-ng]) enable such passive
eavesdropping attacks, even if the local wireless network is
operating in a secure fashion. A passive network attacker using such
tools can steal session identifiers/cookies and hijack the user&rsquo;s web
session(s) by obtaining cookies containing authentication credentials
[ForceHTTPS]. For example, there exist widely available tools, such
as Firesheep (a web browser extension) [Firesheep], that enable their
wielder to obtain other local users&rsquo; session cookies for various web
applications.</p></blockquote><blockquote><p>To mitigate such threats, some web sites support, but usually do not
force, access using end-to-end secure transport &ndash; e.g., signaled
through URIs constructed with the &ldquo;https&rdquo; scheme [RFC2818]. This can
lead users to believe that accessing such services using secure
transport protects them from passive network attackers.
Unfortunately, this is often not the case in real-world deployments,
as session identifiers are often stored in non-Secure cookies to
permit interoperability with versions of the service offered over
insecure transport (&ldquo;Secure cookies&rdquo; are those cookies containing the
&ldquo;Secure&rdquo; attribute [RFC6265]). For example, if the session
identifier for a web site (an email service, say) is stored in a
non-Secure cookie, it permits an attacker to hijack the user&rsquo;s
session if the user&rsquo;s UA makes a single insecure HTTP request to the
site.</p></blockquote><h2 id="active-network-attacks">Active Network Attacks</h2><blockquote><p>A determined attacker can mount an active attack, either by
impersonating a user&rsquo;s DNS server or, in a wireless network, by
spoofing network frames or offering a similarly named evil twin
access point. If the user is behind a wireless home router, an
attacker can attempt to reconfigure the router using default
passwords and other vulnerabilities. Some sites, such as banks, rely
on end-to-end secure transport to protect themselves and their users
from such active attackers. Unfortunately, browsers allow their
users to easily opt out of these protections in order to be usable for sites that incorrectly deploy secure transport, for example by
generating and self-signing their own certificates (without also
distributing their certification authority (CA) certificate to their
users&rsquo; browsers).</p></blockquote><h2 id="website-development--deployment-bugs">Website Development & Deployment Bugs</h2><blockquote><p>The security of an otherwise uniformly secure site (i.e., all of its
content is materialized via &ldquo;https&rdquo; URIs) can be compromised
completely by an active attacker exploiting a simple mistake, such as
the loading of a cascading style sheet or a SWF (Shockwave Flash)
movie over an insecure connection (both cascading style sheets and
SWF movies can script the embedding page, to the surprise of many web
developers, plus some browsers do not issue so-called &ldquo;mixed content
warnings&rdquo; when SWF files are embedded via insecure connections).
Even if the site&rsquo;s developers carefully scrutinize their login page
for &ldquo;mixed content&rdquo;, a single insecure embedding anywhere on the
overall site compromises the security of their login page because an
attacker can script (i.e., control) the login page by injecting code
(e.g., a script) into another, insecurely loaded, site page.</p></blockquote><blockquote><p>NOTE: &ldquo;Mixed content&rdquo; as used above (see also Section 5.3 in
[W3C.REC-wsc-ui-20100812]) refers to the notion termed &ldquo;mixed
security context&rdquo; in this specification and should not be
confused with the same &ldquo;mixed content&rdquo; term used in the
context of markup languages such as XML and HTML.</p></blockquote><h2 id="implementation-details">Implementation Details</h2><p>Implementing the HSTS from the web server is simply a case of having the site running over HTTPS and appending a single header onto the response. The header required is:</p><pre><code>Strict-Transport-Security: max-age=300
</code></pre><p>Alternatively, if you wish the security to cover all sub-domains of your site, then the header is:</p><pre><code>Strict-Transport-Security: max-age=300; includeSubDomains
</code></pre><p><em>Where 300 is, replace with the duration in seconds.</em></p><h2 id="implementing-hsts-as-an-action-filter">Implementing HSTS as an action filter</h2><p>The implementation that I provide below <strong>SHOULD</strong> be used alongside the <code>RequireHttpsAttribute</code> in order to have the specification fully implemented. The reason is that the header will only be sent over a secure connection, if not already present. Furthermore, the <code>RequireHttpsAttribute</code> already takes care of the redirection to a secure connection, so this is not something that I have to worry about implementing correctly.</p><h2 id="browser-support">Browser support</h2><ul><li>Chromium and Google Chrome since version 4.0.211.0</li><li>Firefox since version 4; with Firefox 17, Mozilla integrates a list of websites supporting HSTS</li><li>Opera since version 12</li><li>Safari as of OS X Mavericks
-Internet Explorer does not support HSTS, but is expected to support it in the next major release after IE 11</li></ul></div></article><hr><div id="recommended"><h4>Book Recommendations</h4><p><i>The books below are ones I would personally buy again. All links are redirect to Amazon.</i></p><div class="flex-container"><div class="flex-box"><a href="https://geni.us/P3Jlg4" target="_blank" ref="nofollow"><img src="https://im5tu.io/img/affiliates/Book1.jpg" width="150" height="200" alt="Writing High Performance .NET Code"></a></div><div class="flex-box"><a href="https://geni.us/qEg8Cx" target="_blank" ref="nofollow"><img src="https://im5tu.io/img/affiliates/Book2.jpg" width="150" height="200" alt="Pro .NET Memory Management"></a></div><div class="flex-box"><a href="https://geni.us/k8HBxBA" target="_blank" ref="nofollow"><img src="https://im5tu.io/img/affiliates/Book3.jpg" width="150" height="200" alt="Pro .NET Benchmarking"></a></div><div class="flex-box"><a href="https://geni.us/4b2QcS" target="_blank" ref="nofollow"><img src="https://im5tu.io/img/affiliates/Book4.jpg" width="150" height="200" alt="Designing Data-Intensive Applications"></a></div></div></div><hr><div class="post-info"><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class="tag"><a href="https://im5tu.io/tags/csharp/">csharp</a></span><span class="tag"><a href="https://im5tu.io/tags/dotnet/">dotnet</a></span><span class="tag"><a href="https://im5tu.io/tags/mvc/">mvc</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>907 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2014-04-21 18:19 +0000</p></div><hr><div id="promotions"><h4>Offers From My Partners</h4><a href="https://geni.us/cws-springer" target="_blank"><img src="https://www.awltovhc.com/image-100677210-11635960" width="468" height="60" alt="10% Off Shop Now!"></a>
<a href="https://geni.us/cws-namecheap" target="_blank"><img src="https://www.awltovhc.com/image-100677210-14326263" width="728" height="90" alt="Popular Domains for just 99 Cents at Namecheap!"></a></div><hr><script src="https://utteranc.es/client.js" repo="Im5tu/im5tu.github.io" issue-term="url" label="Comment" theme="photon-dark" crossorigin="anonymous" async></script><div class="pagination"><div class="pagination__title"><span class="pagination__title-h"></span><hr></div><div class="pagination__buttons"><span class="button previous"><a href="https://im5tu.io/article/2014/06/enabling-http-strict-transport-security-hsts-via-web-config/"><span class="button__icon">←</span>
<span class="button__text">Enabling HTTP Strict Transport Security HSTS via Web Config</span></a></span>
<span class="button next"><a href="https://im5tu.io/article/2014/03/sap-business-one-v9-version-strings/"><span class="button__text">SAP Business One V9 Version Strings</span>
<span class="button__icon">→</span></a></span></div></div></main></div><footer class="footer"><hr><div class="footer__inner"><div class="footer__content"><iframe src="https://codewithstu.substack.com/embed" width="480" height="320" style="border:1px solid #eee;background:#fff" frameborder="0" scrolling="no"></iframe></div></div><hr><div><div class="footer__inner"><div class="footer__content"><span>&copy; 2023</span>
<span><a href="https://im5tu.io/">Stuart Blackler</a></span>
<span><a href="https://im5tu.io/article/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div><p><a href="https://im5tu.io/tags">Tags</a> | <a href="https://im5tu.io/categories">Categories</a> | <a href="https://im5tu.io/sitemap.xml">Sitemap</a></p></div><div><p>This site uses Google Analytics for Analytics only, so may contain cookies.</p></div></div></footer></div><script type="text/javascript" src="https://im5tu.io/bundle.min.205d491810c28f95aa953fae884e1c27abe13fdf93ec63b882d0036b248d4a6282eb2d134e4e7225c6ad6e86db87b08488a361ca4a7383d01fcff43f3d57b9c3.js" integrity="sha512-IF1JGBDCj5WqlT+uiE4cJ6vhP9+T7GO4gtADaySNSmKC6y0TTk5yJcatbobbh7CEiKNhykpzg9Afz/Q/PVe5ww=="></script>
<script src="https://im5tu.io/js/site-376a1eef.js" defer></script></body></html>