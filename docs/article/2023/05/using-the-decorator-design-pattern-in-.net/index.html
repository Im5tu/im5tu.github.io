<!doctype html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="author" content="Stuart Blackler "><meta name="description" content="Discover how to use the Decorator design pattern in C#/.NET to add new behaviours to an object dynamically without changing its underlying structure. See how you can make your code more maintainable and extensible, and see step-by-step instructions for implementing it in C#. Find out how to use the Decorator pattern with dependency injection."><meta name="keywords" content=",csharp,dotnet,design patterns"><meta name="robots" content="noodp"><meta name="theme-color" content><link rel="canonical" href="https://im5tu.io/article/2023/05/using-the-decorator-design-pattern-in-.net/"><title>Using The Decorator Design Pattern in .NET :: CodeWithStu's Blog</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" integrity="sha512-Cv93isQdFwaKBV+Z4X8kaVBYWHST58Xb/jVOcV9aRsGSArZsgAnFIhMpDoMDcFNoUtday1hdjn0nGp3+KZyyFw==" crossorigin="anonymous" referrerpolicy="no-referrer"><link rel="stylesheet" href="https://im5tu.io/main.b78c3be9451dc4ca61ca377f3dc2cf2e6345a44c2bae46216a322ef366daa399.css" integrity="sha256-t4w76UUdxMphyjd/PcLPLmNFpEwrrkYhajIu82bao5k="><link rel="apple-touch-icon" sizes="180x180" href="https://im5tu.io/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://im5tu.io/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://im5tu.io/favicon-16x16.png"><link rel="manifest" href="https://im5tu.io/site.webmanifest"><link rel="mask-icon" href="https://im5tu.io/safari-pinned-tab.svg" color><link rel="shortcut icon" href="https://im5tu.io/favicon.ico"><meta name="msapplication-TileColor" content><meta itemprop="name" content="Using The Decorator Design Pattern in .NET"><meta itemprop="description" content="Discover how to use the Decorator design pattern in C#/.NET to add new behaviours to an object dynamically without changing its underlying structure. See how you can make your code more maintainable and extensible, and see step-by-step instructions for implementing it in C#. Find out how to use the Decorator pattern with dependency injection."><meta itemprop="datePublished" content="2023-05-08T07:00:00+00:00"><meta itemprop="dateModified" content="2023-05-08T07:00:00+00:00"><meta itemprop="wordCount" content="943"><meta itemprop="keywords" content="csharp,dotnet,design patterns,"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Using The Decorator Design Pattern in .NET"><meta name="twitter:description" content="Discover how to use the Decorator design pattern in C#/.NET to add new behaviours to an object dynamically without changing its underlying structure. See how you can make your code more maintainable and extensible, and see step-by-step instructions for implementing it in C#. Find out how to use the Decorator pattern with dependency injection."><meta property="og:title" content="Using The Decorator Design Pattern in .NET"><meta property="og:description" content="Discover how to use the Decorator design pattern in C#/.NET to add new behaviours to an object dynamically without changing its underlying structure. See how you can make your code more maintainable and extensible, and see step-by-step instructions for implementing it in C#. Find out how to use the Decorator pattern with dependency injection."><meta property="og:type" content="article"><meta property="og:url" content="https://im5tu.io/article/2023/05/using-the-decorator-design-pattern-in-.net/"><meta property="article:section" content="article"><meta property="article:published_time" content="2023-05-08T07:00:00+00:00"><meta property="article:modified_time" content="2023-05-08T07:00:00+00:00"><meta property="og:see_also" content="https://im5tu.io/article/2023/05/using-the-singleton-design-pattern-in-.net/"><meta property="og:see_also" content="https://im5tu.io/article/2023/03/using-the-builder-design-pattern-in-.net/"><meta property="article:section" content="Development"><meta property="article:published_time" content="2023-05-08 07:00:00 +0000 UTC"><meta property="og:image" content="https://im5tu.io/img/profile.png"><meta property="og:site_name" content="CodeWithStu's Blog"><link rel="alternate" type="application/rss+xml" href="https://im5tu.io/article/index.xml" title="Stuart Blackler's Blog"><link rel="preconnect" href="https://api.github.com"><link rel="preconnect" href="https://partner.googleadservices.com"><link rel="preconnect" href="https://tpc.googlesyndication.com"><link rel="preconnect" href="https://www.googletagservices.com"><link rel="preconnect" href="https://googleads.g.doubleclick.net"><link rel="preconnect" href="https://pagead2.googlesyndication.com"><link rel="preload" href="https://im5tu.io/fonts/Inter-UI-Bold.woff2"><link rel="preload" href="https://im5tu.io/fonts/Inter-UI-Regular.woff2"><style>body p{line-height:1.8em}main{padding:4em 0 0}a:hover{color:#004dc9}.post,.posts{max-width:1400px;padding:4em 0 0}.header__inner{width:100%;max-width:1400px}ul.menu__inner{padding-right:0}ul.menu__inner li:last-of-type{margin-right:0}.logo__cursor{background:#3b82f6}.toolbar{display:none!important}.copy-code-button{float:right;display:block;padding:8px 12px;font-size:.9em;background-color:#e2e2e2;border-left:1px solid #e2e2e2;border-bottom:1px solid #e2e2e2;border-radius:0;border-bottom-left-radius:10px;transition:all 250ms ease;margin:-18px;opacity:0}.copy-code-button:hover{cursor:pointer;opacity:.7;border-style:solid}.copy-code-button:focus{background-color:#e2e2e2;outline:0;border-style:solid}.copy-code-button:active{background-color:#e2e2e2;opacity:.5;border-style:solid}pre:hover .copy-code-button{opacity:1}.copy-code-button~pre{position:relative}table{width:100%;border-collapse:collapse}table th{background-color:#cecece;color:#222}table tr{margin:0;padding:0}table tr:first-child{border-left:1px solid #acacac;border-top:1px solid #acacac;border-right:1px solid #acacac}table tr td:first-child{border-left:1px solid #acacac}table tr td:last-child{border-right:1px solid #acacac}table td,table th{padding:.5em;border-bottom:1px solid #acacac;margin:0}h2{margin-top:1.5em}h2 a:link,h2 a:visited,h3 a:link,h3 a:visited,h4 a:link,h4 a:visited,h5 a:link,h5 a:visited{text-decoration:none}h2 a:hover,h3 a:hover,h4 a:hover,h5 a:hover{text-decoration:underline}#promotions img{margin:20px auto}#sponsorMessage{width:100%;background:#ffdf00;color:#242325;padding:10px;font-size:.9em}.flex-container{width:100%;display:inline-flex;justify-content:space-between}.flex-box{display:block}.hidden{display:hidden}.post-title{font-weight:700}.post-summary{font-style:italic;font-size:.8em;color:#222}.post-tags{font-size:.9em}.post-tags span.tag{margin:0 .5em;color:#111;text-decoration:underline}#introduction{margin:0 auto;text-align:center}#introduction p{display:block;text-align:center}#introduction p:first-child{font-weight:700;font-size:1.4em}#introduction p:nth-child(2){font-size:1.3em;font-style:italic}#introduction-container{width:80%;max-width:1400px;text-align:center}#introduction-whatido{margin-top:2em;background-color:#fafafa;width:100%;padding:3em 0}#introduction-whatido *{text-align:center}#introduction-whatido p{text-align:justify}#introduction-whatido .flex-box{margin:0 2.5em;width:100%}#introduction-whatido .flex-box span.home-link{font-size:1.8em;margin-bottom:2em;color:#0665ff;font-weight:700;text-align:center}#introduction-whatido .flex-box span.home-link a,#introduction-whatido .flex-box span.home-link a:link{text-align:center;text-decoration:none}.footer{padding:0}#scroll-progress{position:absolute;bottom:0;left:0;width:0%;height:4px;background:#0665ff;z-index:10000}.header{position:fixed;top:0;width:100%;z-index:10000}@media print{.copy-code-button{display:none}}@media(prefers-color-scheme:dark){.copy-code-button{background-color:#969696;color:#323232}.post-summary,.post-tags span.tag{color:#eaeaea}}@media(max-width:1450px){.post,.posts,main{padding:4em}}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QLMVXHCJ5K"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QLMVXHCJ5K")</script><script data-ad-client="ca-pub-8597760177900459" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div class="container"><header class="header"><span class="header__inner"><a href="https://im5tu.io/" style="text-decoration:none"><div class="logo"><span class="logo__mark">></span>
<span class="logo__text">CodeWithStu</span>
<span class="logo__cursor"></span></div></a><span class="header__right"><nav class="menu"><ul class="menu__inner"><li><a href="https://im5tu.io/article/">Blog</a></li><li><a href="https://news.codewithstu.tv">Newsletter</a></li><li><a href="https://www.patreon.com/CodeWithStu">Patreon</a></li><li><a href="https://twitter.com/CodeWithStu">Twitter</a></li><li><a href="https://codewithstu.tv">YouTube</a></li></ul></nav><span class="menu-trigger"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span><div id="scroll-progress"></div></header><div class="content"><main class="post"><div style="font-style:italic;width:100%;background-color:#ffe12b;color:#333;text-align:center;padding:1px"><p>This page is available to sponsor. <a id="sponsorLink" href="https://im5tu.io/sponsorship/" ref="nofollow" target="_blank">Click Here</a> for more details!</p></div><div class="post-info"><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>5 minutes</p></div><article><h1 class="post-title"><a href="https://im5tu.io/article/2023/05/using-the-decorator-design-pattern-in-.net/">Using The Decorator Design Pattern in .NET</a></h1><hr><aside id="toc"><div class="toc-title">Table of Contents</div><nav id="TableOfContents"><ul><li><a href="#what-is-the-decorator-design-pattern">What Is The Decorator Design Pattern?</a></li><li><a href="#implementing-the-decorator-design-pattern-in-c">Implementing The Decorator Design Pattern In C#</a></li><li><a href="#the-decorator-design-pattern--dependency-injection">The Decorator Design Pattern & Dependency Injection</a></li><li><a href="#frequently-asked-questions-about-the-decorator-design-pattern">Frequently Asked Questions About The Decorator Design Pattern</a><ul><li><a href="#what-are-some-real-world-usages-of-the-decorator-design-pattern">What Are Some Real-World Usages Of The Decorator Design Pattern?</a></li><li><a href="#can-the-decorator-design-pattern-be-used-to-modify-existing-behaviour-of-an-object">Can The Decorator Design Pattern Be Used To Modify Existing Behaviour Of An Object?</a></li><li><a href="#how-does-the-decorator-design-pattern-differ-from-inheritance">How Does The Decorator Design Pattern Differ From Inheritance?</a></li></ul></li></ul></nav></aside><hr><div class="post-content"><div style="font-style:italic;width:100%;background-color:#63e5ff;color:#333;text-align:center;padding:5px"><p>This post is part of the <a href="#series" style="font-weight:700">Design Patterns In Dotnet</a> series.</p></div><p>The Decorator design pattern is a widely-used technique for extending the functionality of an existing object or component. By wrapping an object in a series of decorators, you can add new behaviours, features, or properties without modifying the underlying code. This makes it a powerful and flexible way to customize and extend software systems. In .NET, the Decorator design pattern can be used in various ways to enhance and modify existing classes and components, which can help you write more maintainable, extensible, and flexible code.</p><h2 id="what-is-the-decorator-design-pattern">What Is The Decorator Design Pattern?</h2><p>The idea behind the Decorator design pattern is to wrap the object you want to modify in a series of decorators, each adding a specific behaviour or feature to the object. In the Decorator design pattern, there are several key components:</p><ol><li>Component: This is the base object or interface you want to modify. It defines the basic behaviour or features of the object.</li><li>Concrete Component: This is the concrete implementation of the component interface. It provides the base functionality of the object.</li><li>Decorator: This is the abstract base class or interface for all decorators. It defines the basic structure of the decorators and how they should interact with the component.</li><li>Concrete Decorator: This is the concrete implementation of the decorator interface. It provides the specific functionality or behaviour you want to add to the component.</li></ol><p>The Decorator design pattern is often used when you need to add new functionality to an object but want to keep its underlying structure the same. This can be useful when you want to keep the existing codebase intact.</p><p>One of the benefits of using the Decorator design pattern is that it allows you to add new behaviours or features to an object without modifying the underlying code. This can make your code more maintainable and extensible, allowing you to add new functionality to an object without changing existing behaviour. By wrapping an object in a series of decorators, you can create complex and customizable objects tailored to your specific needs.</p><h2 id="implementing-the-decorator-design-pattern-in-c">Implementing The Decorator Design Pattern In C#</h2><p>There are two different ways of implementing the decorator pattern. Like <a href="https://im5tu.io/article/2023/05/using-the-singleton-design-pattern-in-.net/">the singleton design pattern</a>, we can construct the pattern manually or with dependency injection. We&rsquo;ll take a look at both, starting with manual creation:</p><ol><li>Define the Component interface or abstract class. This is the base object or interface that you want to modify. It defines the basic behaviour or features of the object:</li></ol><pre><code class="language-csharp">public interface IComponent
{
    void Operation();
}
</code></pre><ol start="2"><li>Create the Concrete Component class. This is the concrete implementation of the component interface. It provides the base functionality of the object.</li></ol><pre><code class="language-csharp">public class ConcreteComponent : IComponent
{
    public void Operation()
    {
        Console.WriteLine(&quot;ConcreteComponent.Operation()&quot;);
    }
}
</code></pre><ol start="3"><li>Create the Decorator abstract class. This is the abstract base class or interface for all decorators. It defines the basic structure of the decorators and how they should interact with the component.</li></ol><pre><code class="language-csharp">public abstract class Decorator : IComponent
{
    protected IComponent _component;

    public Decorator(IComponent component)
    {
        _component = component;
    }

    public virtual void Operation()
    {
        _component.Operation();
    }
}
</code></pre><ol start="4"><li>Create the Concrete Decorator class. This is the concrete implementation of the decorator interface. It provides the specific functionality or behaviour that you want to add to the component.</li></ol><pre><code class="language-csharp">public class ConcreteDecoratorA : Decorator
{
    public ConcreteDecoratorA(IComponent component) : base(component)
    {
    }

    public override void Operation()
    {
        base.Operation();
        Console.WriteLine(&quot;ConcreteDecoratorA.Operation()&quot;);
    }
}

public class ConcreteDecoratorB : Decorator
{
    public ConcreteDecoratorB(IComponent component) : base(component)
    {
    }

    public override void Operation()
    {
        base.Operation();
        Console.WriteLine(&quot;ConcreteDecoratorB.Operation()&quot;);
    }
}
</code></pre><ol start="5"><li>Implement the Decorator design pattern by wrapping components in decorators.</li></ol><pre><code class="language-csharp">IComponent component = new ConcreteComponent();
component = new ConcreteDecoratorA(component);
component = new ConcreteDecoratorB(component);

component.Operation();
</code></pre><p>When the above code is run, we end up with the following output:</p><pre><code class="language-bash">ConcreteComponent.Operation()
ConcreteDecoratorA.Operation()
ConcreteDecoratorB.Operation()
</code></pre><p>The order of the output can easily be changed by changing the implementation of the decorators. Note that by using interfaces and abstract classes, we can create a flexible and extensible system that can be easily customized and modified.</p><h2 id="the-decorator-design-pattern--dependency-injection">The Decorator Design Pattern & Dependency Injection</h2><p>The Decorator design pattern can also easily be used with dependency injection frameworks using NuGet packages like <a href="https://github.com/khellang/Scrutor">Scrutor</a>. If we use the classes/interfaces that we&rsquo;ve previously declared, we can add dependency injection as follows:</p><pre><code class="language-csharp">using Microsoft.Extensions.DependencyInjection;

var services = new ServiceCollection()
                    .AddScoped&lt;IComponent, ConcreteComponent&gt;()
                    .Decorate&lt;IComponent, ConcreteDecoratorA&gt;()
                    .Decorate&lt;IComponent, ConcreteDecoratorB&gt;()
                    .BuildServiceProvider();

services.GetRequiredService&lt;IComponent&gt;().Operation();

// ...component definitions below...
</code></pre><p>This helps prevent the need for manual construction of objects which could reduce a large amount of repetitive code when the object being decorated has a lot of dependencies. The above code produces this output:</p><pre><code class="language-bash">ConcreteComponent.Operation()
ConcreteDecoratorA.Operation()
ConcreteDecoratorB.Operation()
</code></pre><h2 id="frequently-asked-questions-about-the-decorator-design-pattern">Frequently Asked Questions About The Decorator Design Pattern</h2><h3 id="what-are-some-real-world-usages-of-the-decorator-design-pattern">What Are Some Real-World Usages Of The Decorator Design Pattern?</h3><ul><li>Adding logging or error handling to a database access component</li><li>Adding caching or throttling to a web service client</li><li>Adding encryption or compression to a file storage component</li><li>Adding formatting or validation to a user input component</li></ul><h3 id="can-the-decorator-design-pattern-be-used-to-modify-existing-behaviour-of-an-object">Can The Decorator Design Pattern Be Used To Modify Existing Behaviour Of An Object?</h3><p>No, the Decorator pattern is designed to add new behaviours or features to an object, not to remove or modify existing behaviour. If you need to change existing behaviour in an object, consider other patterns like the Strategy pattern or the Template Method pattern.</p><h3 id="how-does-the-decorator-design-pattern-differ-from-inheritance">How Does The Decorator Design Pattern Differ From Inheritance?</h3><p>Inheritance is another way to add new behaviours or features to an object, but it differs from the Decorator pattern in several ways. Inheritance is a static relationship between classes, whereas the Decorator pattern is a dynamic relationship between objects. Inheritance can lead to a problematic class hierarchy to maintain and extend, whereas the Decorator pattern allows for more flexible and modular code.</p></div></article><hr><div class="post-info"><a name="series"></a>
<b>More in the Design Patterns In Dotnet series:</b><ol><li><a href="https://im5tu.io/article/2023/03/using-the-builder-design-pattern-in-.net/">Using the Builder Design Pattern in .NET</a></li><li><a href="https://im5tu.io/article/2023/05/using-the-singleton-design-pattern-in-.net/">Using The Singleton Design Pattern in .NET</a></li><li><b>Using The Decorator Design Pattern in .NET <i>(This article)</i></b></li></ol><p><a href="https://im5tu.io/series/design-patterns-in-dotnet/">View All Articles</a></p><hr><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class="tag"><a href="https://im5tu.io/tags/csharp/">csharp</a></span><span class="tag"><a href="https://im5tu.io/tags/dotnet/">dotnet</a></span><span class="tag"><a href="https://im5tu.io/tags/design-patterns/">design patterns</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>943 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2023-05-08</p></div><hr><div id="promotions"><a href="https://geni.us/cws-springer" target="_blank"><img src="https://www.awltovhc.com/image-100677210-15518210" width="728" height="90" alt="Apress eBook Sale is here now! - Order selected eBooks for $12.99 each. (3rd-20th May)"></a>
<a href="https://geni.us/cws-namecheap" target="_blank"><img src="https://www.awltovhc.com/image-100677210-14326263" width="728" height="90" alt="Popular Domains for just 99 Cents at Namecheap!"></a>
<a href="https://geni.us/cws-mailchimp" target="_blank"><img src="https://www.ftjcfx.com/image-100677210-15488213" width="728" height="90" alt="See upto 88% more revenue with predictive segments!"></a></div></main></div><footer class="footer"><hr><div class="footer__inner"><div class="footer__content"><iframe src="https://codewithstu.substack.com/embed" width="480" height="320" frameborder="0" scrolling="no"></iframe></div></div><hr><div><div class="footer__inner"><div class="footer__content"><span>&copy; 2023</span>
<span><a href="https://im5tu.io/">Stuart Blackler</a></span>
<span><a href="https://im5tu.io/article/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div><p><a href="https://im5tu.io/tags">Tags</a> | <a href="https://im5tu.io/categories">Categories</a> | <a href="https://im5tu.io/sitemap.xml">Sitemap</a></p></div><div><p>This site uses Google Analytics for Analytics only, so may contain cookies.</p></div></div></footer></div><script type="text/javascript" src="https://im5tu.io/bundle.min.205d491810c28f95aa953fae884e1c27abe13fdf93ec63b882d0036b248d4a6282eb2d134e4e7225c6ad6e86db87b08488a361ca4a7383d01fcff43f3d57b9c3.js" integrity="sha512-IF1JGBDCj5WqlT+uiE4cJ6vhP9+T7GO4gtADaySNSmKC6y0TTk5yJcatbobbh7CEiKNhykpzg9Afz/Q/PVe5ww=="></script>
<script src="https://im5tu.io/js/site-004f8284.js" defer></script></body></html>